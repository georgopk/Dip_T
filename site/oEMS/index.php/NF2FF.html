<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15.1" />
		<meta name="keywords" content="NF2FF,CSXCAD,Dump Box Property" />
		<link rel="shortcut icon" href="http://openems.de/index.php/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://openems.de/index.php/opensearch_desc.php" title="openEMS (en)" />
		<link title="Creative Commons" type="application/rdf+xml" href="http://openems.de/index.php/index.php?title=NF2FF&amp;action=creativecommons" rel="meta" />
		<link rel="copyright" href="https://creativecommons.org/licenses/by-sa/3.0/deed.de" />
		<link rel="alternate" type="application/rss+xml" title="openEMS RSS Feed" href="http://openems.de/index.php/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="openEMS Atom Feed" href="http://openems.de/index.php/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>NF2FF - openEMS</title>
		<link rel="stylesheet" href="../skins/common/shared.css%3F207.css" type="text/css" media="screen" />
		<link rel="stylesheet" href="../skins/common/commonPrint.css%3F207.css" type="text/css" media="print" />
		<link rel="stylesheet" href="../skins/monobook/main.css%3F207.css" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE50Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE55Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="http://openems.de/index.php/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="http://openems.de/index.php/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" media="print" />
		<link rel="stylesheet" href="http://openems.de/index.php/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="http://openems.de/index.php/index.php?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?207"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins";
		var wgArticlePath = "/index.php/$1";
		var wgScriptPath = "";
		var wgScript = "/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "NF2FF";
		var wgTitle = "NF2FF";
		var wgAction = "view";
		var wgArticleId = "136";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 992;
		var wgVersion = "1.15.1";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="../skins/common/wikibits.js%3F207"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="../skins/common/ajax.js%3F207"></script>
		<script type="text/javascript" src="http://openems.de/index.php/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	<style type='text/css'> #turnkey-credit { font-family: Tahoma,Sans,Arial,Helvetica,Verdana,sans-serif; font-size: 11px; text-align: center; } #turnkey-credit a { text-decoration: none; } #turnkey-credit a:hover { text-decoration: underline; } </style></head>
<body class="mediawiki ltr ns-0 ns-subject page-NF2FF skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">NF2FF</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From openEMS</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="NF2FF.html#column-one">navigation</a>, <a href="NF2FF.html#searchInput">search</a></div>			<!-- start content -->
			<p>Create and calculate the near-field to far-field transformation. The NF2FF box must be defined before running the FDTD simulations.</p>
<p><a name="NF2FF_Creation" id="NF2FF_Creation"></a></p>
<h2><span class="mw-headline">NF2FF Creation</span></h2>
<p>The function <i>CreateNF2FFBox</i> will create surface <a href="Dump_Box_Property.html" title="Dump Box Property">dump-boxes</a> surrounding the structure. The hdf5 file format is used to store the electric and magnetic fields necessary to perform the near-field to far-field transformation.</p>
<p>Create a near-field to far-field box:</p>
<pre>
[CSX nf2ff] = CreateNF2FFBox(CSX, name, start, stop, varargin)
</pre>
<p>The parameters are:</p>
<ul>
<li><b>CSX</b>: The <a href="CSXCAD.html" title="CSXCAD">CSXCAD</a> data structure to be manipulated.</li>
<li><b>name</b>: The name of the nf2ff calculation, it will be part of the hdf5 dump filenames</li>
<li><b>start/stop</b>: Start and stop coordinates of the nf2ff box, it should contain all structures and should not be inside the pml!</li>
</ul>
<p>Return parameters are:</p>
<ul>
<li><b>CSX</b>: The manipulated <a href="CSXCAD.html" title="CSXCAD">CSXCAD</a> data structure.</li>
<li><b>nf2ff</b>: A data structure containing all necessary information to perform the near-field to far-field transformation. See <i>CalcNF2FF</i> below.</li>
</ul>
<p>Optional/variable arguments are:</p>
<ul>
<li><b>Frequency</b>: Specify a frequency vector to save disk-space. By default time-domain data will be stored.</li>
<li><b>OptResolution</b>: Dump fields only for a given optimal resolution (e.g.: 'OptResolution', c0/max_freq/unit/15) to save disk-space</li>
<li><b>Directions</b>: A 6x1 array, showing which directions are enabled/disabled for the NF2FF calculations. The numbers in the array represent [x(-), x(+), y(-), y(+), z(-), z(+)]. Each value can be either 1 (enabled) or 0 (disabled). Usually this is only used to disable some directions in case of a full cylindrical mesh. For a Cartesian mesh this should not be changed.</li>
</ul>
<p><a name="NF2FF_Calculation" id="NF2FF_Calculation"></a></p>
<h2><span class="mw-headline">NF2FF Calculation</span></h2>
<p><b>Note:</b>: This function can only be used after a simulation has been performed and all electric and magnetic fields have been stored as defined by <i>CreateNF2FFBox</i>.</p>
<p><b>IMPORTANT</b>: Make sure to define the correct nf2ff phase center, aka. central antenna position! See optional parameter below!! Default is [0 0 0]</p>
<p>The function to calculate the far field is called by</p>
<pre>
nf2ff = CalcNF2FF(nf2ff, Sim_Path, freq, theta, phi, varargin)
</pre>
<p><br />
The parameters are:</p>
<ul>
<li><b>nf2ff</b>: data structure created by CreateNF2FFBox</li>
<li><b>Sim_Path</b>: path to simulation data</li>
<li><b>freq</b>: array of frequencies to analyze</li>
<li><b>theta,phi</b>: spherical coordinates to evaluate the far-field on (in radians)</li>
</ul>
<p>Optional parameters are:</p>
<ul>
<li><b>Center</b>: nf2ff phase center, default is [0 0 0]. Make sure the center is never outside of your nf2ff box. Unit is always meters.</li>
</ul>
<ul>
<li><b>Mode</b>:
<ul>
<li>'Mode', 0 -&gt; read only, if data already exist (default)</li>
<li>'Mode', 1 -&gt; calculate anyway, overwrite existing</li>
<li>'Mode', 2 -&gt; read only, fail if not existing</li>
</ul>
</li>
<li><b>Outfile</b>: alternative nf2ff result hdf5 file name. Default is: &lt;nf2ff.name&gt;.h5</li>
<li><b>Verbose</b>: set verbose level for the nf2ff calculation 0-2 supported</li>
</ul>
<p><a name="NF2FF_Output" id="NF2FF_Output"></a></p>
<h2><span class="mw-headline">NF2FF Output</span></h2>
<p>After performing the NF2FF calculations the nf2ff struct will look like:</p>
<pre>
nf2ff = 

           name: 'nf2ff'
    filenames_E: {'nf2ff_E_xn'  'nf2ff_E_xp'  'nf2ff_E_yn'  'nf2ff_E_yp'  'nf2ff_E_zn'  'nf2ff_E_zp'}
    filenames_H: {'nf2ff_H_xn'  'nf2ff_H_xp'  'nf2ff_H_yn'  'nf2ff_H_yp'  'nf2ff_H_zn'  'nf2ff_H_zp'}
     directions: [6x1 double]
    CoordSystem: 0
            xml: 'Sphere_RCS_small/nf2ff.xml'
           hdf5: 'Sphere_RCS_small/nf2ff.h5'
              r: 1
          theta: [181x1 double]
            phi: [361x1 double]
           freq: [20x1 double]
           Prad: [20x1 double]
           Dmax: [20x1 double]
        E_theta: {1x20 cell}
          E_phi: {1x20 cell}
         E_norm: {1x20 cell}
          P_rad: {1x20 cell}


</pre>
<p><br /></p>
<div class="thumb tright">
<div class="thumbinner" style="width:202px;"><a href="File:FarFieldCoordinates.svg.html" class="image" title="The field components of the far field: Eθ lies in the plane spanned by the z-axis and (θ,φ); Eφ is orthogonal to that"><img alt="" src="../images/thumb/1/19/FarFieldCoordinates.svg/200px-FarFieldCoordinates.svg.png" width="200" height="194" border="0" class="thumbimage" /></a>
<div class="thumbcaption">
<div class="magnify"><a href="File:FarFieldCoordinates.svg.html" class="internal" title="Enlarge"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>
The field components of the far field: <span class="texhtml"><i>E</i><sub>θ</sub></span> lies in the plane spanned by the z-axis and <span class="texhtml">(θ,φ)</span>; <span class="texhtml"><i>E</i><sub>φ</sub></span> is orthogonal to that</div>
</div>
</div>
<p>The content of the individual fields is as follows:</p>
<ul>
<li><b>name</b>: The name of the NF2FF box used to calculate the far field.</li>
<li><b>filenames_E</b>: (internal) Filenames of all electric field dump boxes for each direction.</li>
<li><b>filenames_H</b>: (internal) Filenames of all magnetic field dump boxes for each direction.</li>
<li><b>directions</b>: (internal) A 6x1 array, showing which directions are enabled/disabled for the NF2FF calculations. The numbers in the array represent [x(-), x(+), y(-), y(+), z(-), z(+)]. Each value can be either 1 (enabled) or 0 (disabled).</li>
<li><b>CoordSystem</b>: (internal) Type of coordinate system for the raw field-data. Can be either a Cartesian (0) or a cylindrical (1) coordinate system.</li>
<li><b>xml</b>: (internal) Path to an xml-file which contains the values of analyzed frequencies and angles as well as the hdf5 file names where the fields are stored.</li>
<li><b>hdf5</b>: (internal) Path to the hdf5-file containing all the nf2ff calculated data</li>
<li><b>r</b>: Radius or distance to the phase center used for the nf2ff calculation (in meter).</li>
<li><b>theta, phi</b>: values of the polar angles of the calculated far field (<img class="tex" alt="\varphi, \theta" src="../images/math/a/9/7/a97f80926b4c64e49eed531c7b5d875d.png" />)</li>
<li><b>frequencies</b>: values of the analyzed frequencies</li>
<li><b>Prad</b>: Total radiated power for each frequency (can be used for antenna efficiency calculation).</li>
<li><b>Dmax</b>: max. antenna directivity</li>
<li><b>E_theta</b>: Complex theta component of the electric far-field for each analyzed frequency and angle (<img class="tex" alt="E_\varphi(r, \varphi, \theta)" src="../images/math/d/9/4/d94d93e42f43409b27d6dd7a981ccd4e.png" />).</li>
<li><b>E_phi</b>: Complex phi component of the electric far-field for each analyzed frequency and angle (<img class="tex" alt="E_\theta(r, \varphi, \theta)" src="../images/math/9/6/b/96bec9d549fc48b17c3a4b721307603a.png" />).</li>
<li><b>E_cprh</b>: (openEMS &gt;v0.0.30) Complex amplitude of right-handed circular polarized electric far-field for each analyzed frequency and angle (<img class="tex" alt="E_{CPRH}(r, \varphi, \theta)" src="../images/math/0/d/1/0d15354064f022348770e90885775b7b.png" />).</li>
<li><b>E_cplh</b>: (openEMS &gt;v0.0.30) Complex amplitude of left-handed circular polarized electric far-field for each analyzed frequency and angle (<img class="tex" alt="E_{CPLH}(r, \varphi, \theta)" src="../images/math/f/8/c/f8c0bbd64af3909b4a5ce4ec7790c9b7.png" />).</li>
<li><b>E_norm</b>: Complex electric field amplitude of the far-field for each analyzed frequency and angle (<img class="tex" alt="|E|(r, \varphi, \theta)" src="../images/math/2/a/7/2a7155eb31a9a215143701e0a1983390.png" />).</li>
<li><b>P_rad</b>: The energy flux in the far field for each analyzed frequency and angle (<img class="tex" alt="P_{rad}(r, \varphi, \theta)" src="../images/math/6/3/2/632cbeb71a1f2c97d0d794a2480b43cd.png" />).</li>
</ul>


<!-- 
NewPP limit report
Preprocessor node count: 43/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key wiki_db:pcache:idhash:136-0!1!0!!en!2!edit=0 and timestamp 20181110114354 -->
<div class="printfooter">
Retrieved from "<a href="NF2FF.html">index.php/NF2FF</a>"</div>
						<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../images/logo.png);" href="http://openems.de/index.php/Main_Page.html" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Front-Page"><a href="https://www.openEMS.de">Front Page</a></li>
				<li id="n-Wiki-Main-Page"><a href="http://openems.de/index.php/Main_Page.html">Wiki Main Page</a></li>
				<li id="n-Forum"><a href="https://www.openEMS.de/forum">Forum</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-documentation'>
		<h5>documentation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Installation"><a href="https://openems.de/index.php/OpenEMS#Installation">Installation</a></li>
				<li id="n-Tutorials"><a href="http://openems.de/index.php/Tutorials.html">Tutorials</a></li>
				<li id="n-Overview"><a href="http://openems.de/index.php/Overview.html">Overview</a></li>
				<li id="n-Online-Manual"><a href="Introduction.html">Online Manual</a></li>
				<li id="n-FAQ"><a href="Frequently_Asked_Questions.html">FAQ</a></li>
				<li id="n-Publications"><a href="http://openems.de/index.php/Publications.html">Publications</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-copyrightico"><a href="https://creativecommons.org/licenses/by-sa/3.0/deed.de"><img src="https://i.creativecommons.org/l/by-sa/3.0/de/88x31.png" alt='Creative Commons 3.0 (CC by-sa)' /></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 27 December 2016, at 00:11.</li>
					<li id="viewcount">This page has been accessed 28,064 times.</li>
					<li id="copyright">Content is available under <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.de" class="external " title="https://creativecommons.org/licenses/by-sa/3.0/deed.de">Creative Commons 3.0 (CC by-sa)</a>.</li>
					<li id="privacy"><a href="../start/index.php%3Fshow=privacy.html" title="openEMS:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="http://openems.de/index.php/index.php/openEMS:About" title="openEMS:About">About openEMS</a></li>
					<li id="privacy"><a href="../start/index.php%3Fshow=imprint.html" title="openEMS:Imprint">Imprint</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</body></html>
